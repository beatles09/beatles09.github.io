<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title>Practical Machine Learning:Course Project</title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1344.72">
  <style type="text/css">
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 20.0px; font: 12.0px Courier; color: #333333; -webkit-text-stroke: #333333; background-color: #f5f5f5}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 20.0px; font: 12.0px Courier; color: #333333; -webkit-text-stroke: #333333; background-color: #ffffff}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 20.0px; font: 12.0px Courier; color: #333333; -webkit-text-stroke: #333333; background-color: #f5f5f5; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<h1 style="margin: 0.0px 0.0px 10.0px 0.0px; line-height: 40.0px; font: 39.0px 'Helvetica Neue'; color: #333333; -webkit-text-stroke: #333333"><span class="s1"><b>Practical Machine Learning:Course Project</b></span></h1>
<h3 style="margin: 0.0px 0.0px 10.0px 0.0px; line-height: 40.0px; font: 25.0px 'Helvetica Neue'; color: #333333; -webkit-text-stroke: #333333"><span class="s1"><b>This code has been written to perform the given task on the data provided to me in a report using a single R markdown document that can be processed by knitr and be transformed into an HTML file.Since the data set has such a great size and we need make a class prediction, random forests model is implemented. The test set error is estimated internally, during the execution. So, we proceed with the training the model (Random Forest) with the training data set. Further details are mentioned in the code. The parallel package provides functions for parallel execution of R code on machines with multiple cores or processors or multiple computers. It is essentially a blend of the snow and multicore packages. By default, the doParallel package uses snow-like functionality. The snow-like functionality should work fine on Unix-like systems. The error obtained is really low which is favourable in this case.</b></span></h3>
<p class="p3"><span class="s1">library(Hmisc)</span></p>
<p class="p4"><span class="s1">## Loading required package: grid</span></p>
<p class="p4"><span class="s1">## Loading required package: lattice</span></p>
<p class="p4"><span class="s1">## Loading required package: survival</span></p>
<p class="p4"><span class="s1">## Loading required package: splines</span></p>
<p class="p4"><span class="s1">## Loading required package: Formula</span></p>
<p class="p4"><span class="s1">## Loading required package: ggplot2</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## Attaching package: 'Hmisc'</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## The following objects are masked from 'package:base':</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">    </span>format.pval, round.POSIXt, trunc.POSIXt, units</span></p>
<p class="p3"><span class="s1">library(caret)</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## Attaching package: 'caret'</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## The following object is masked from 'package:survival':</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">    </span>cluster</span></p>
<p class="p3"><span class="s1">library(randomForest)</span></p>
<p class="p4"><span class="s1">## randomForest 4.6-10</span></p>
<p class="p4"><span class="s1">## Type rfNews() to see new features/changes/bug fixes.</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## Attaching package: 'randomForest'</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## The following object is masked from 'package:Hmisc':</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">    </span>combine</span></p>
<p class="p3"><span class="s1">library(foreach)</span></p>
<p class="p3"><span class="s1">library(doParallel)</span></p>
<p class="p4"><span class="s1">## Loading required package: iterators</span></p>
<p class="p4"><span class="s1">## Loading required package: parallel</span></p>
<p class="p3"><span class="s1">set.seed(123)</span></p>
<p class="p3"><span class="s1">td &lt;- read.csv("pml-training.csv", na.strings=c("#DIV/0!") )</span></p>
<p class="p3"><span class="s1">ed &lt;- read.csv("pml-testing.csv", na.strings=c("#DIV/0!") )</span></p>
<p class="p3"><span class="s1">for(i in c(8:ncol(td)-1)) {td[,i] = as.numeric(as.character(td[,i]))}</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p3"><span class="s1">for(i in c(8:ncol(ed)-1)) {ed[,i] = as.numeric(as.character(ed[,i]))}</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p4"><span class="s1">## Warning: NAs introduced by coercion</span></p>
<p class="p3"><span class="s1">sets &lt;- colnames(td[colSums(is.na(td)) == 0])[-(1:7)]</span></p>
<p class="p3"><span class="s1">model &lt;- td[sets]</span></p>
<p class="p3"><span class="s1">sets</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">  </span>[1] "roll_belt"<span class="Apple-converted-space">            </span>"pitch_belt" <span class="Apple-converted-space">          </span>"yaw_belt" <span class="Apple-converted-space">           </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">  </span>[4] "total_accel_belt" <span class="Apple-converted-space">    </span>"gyros_belt_x" <span class="Apple-converted-space">        </span>"gyros_belt_y" <span class="Apple-converted-space">       </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">  </span>[7] "gyros_belt_z" <span class="Apple-converted-space">        </span>"accel_belt_x" <span class="Apple-converted-space">        </span>"accel_belt_y" <span class="Apple-converted-space">       </span></span></p>
<p class="p4"><span class="s1">## [10] "accel_belt_z" <span class="Apple-converted-space">        </span>"magnet_belt_x"<span class="Apple-converted-space">        </span>"magnet_belt_y"<span class="Apple-converted-space">       </span></span></p>
<p class="p4"><span class="s1">## [13] "magnet_belt_z"<span class="Apple-converted-space">        </span>"roll_arm" <span class="Apple-converted-space">            </span>"pitch_arm"<span class="Apple-converted-space">           </span></span></p>
<p class="p4"><span class="s1">## [16] "yaw_arm"<span class="Apple-converted-space">              </span>"total_accel_arm"<span class="Apple-converted-space">      </span>"gyros_arm_x"<span class="Apple-converted-space">         </span></span></p>
<p class="p4"><span class="s1">## [19] "gyros_arm_y"<span class="Apple-converted-space">          </span>"gyros_arm_z"<span class="Apple-converted-space">          </span>"accel_arm_x"<span class="Apple-converted-space">         </span></span></p>
<p class="p4"><span class="s1">## [22] "accel_arm_y"<span class="Apple-converted-space">          </span>"accel_arm_z"<span class="Apple-converted-space">          </span>"magnet_arm_x" <span class="Apple-converted-space">       </span></span></p>
<p class="p4"><span class="s1">## [25] "magnet_arm_y" <span class="Apple-converted-space">        </span>"magnet_arm_z" <span class="Apple-converted-space">        </span>"roll_dumbbell"<span class="Apple-converted-space">       </span></span></p>
<p class="p4"><span class="s1">## [28] "pitch_dumbbell" <span class="Apple-converted-space">      </span>"yaw_dumbbell" <span class="Apple-converted-space">        </span>"total_accel_dumbbell"</span></p>
<p class="p4"><span class="s1">## [31] "gyros_dumbbell_x" <span class="Apple-converted-space">    </span>"gyros_dumbbell_y" <span class="Apple-converted-space">    </span>"gyros_dumbbell_z" <span class="Apple-converted-space">   </span></span></p>
<p class="p4"><span class="s1">## [34] "accel_dumbbell_x" <span class="Apple-converted-space">    </span>"accel_dumbbell_y" <span class="Apple-converted-space">    </span>"accel_dumbbell_z" <span class="Apple-converted-space">   </span></span></p>
<p class="p4"><span class="s1">## [37] "magnet_dumbbell_x"<span class="Apple-converted-space">    </span>"magnet_dumbbell_y"<span class="Apple-converted-space">    </span>"magnet_dumbbell_z"<span class="Apple-converted-space">   </span></span></p>
<p class="p4"><span class="s1">## [40] "roll_forearm" <span class="Apple-converted-space">        </span>"pitch_forearm"<span class="Apple-converted-space">        </span>"yaw_forearm"<span class="Apple-converted-space">         </span></span></p>
<p class="p4"><span class="s1">## [43] "total_accel_forearm"<span class="Apple-converted-space">  </span>"gyros_forearm_x"<span class="Apple-converted-space">      </span>"gyros_forearm_y"<span class="Apple-converted-space">     </span></span></p>
<p class="p4"><span class="s1">## [46] "gyros_forearm_z"<span class="Apple-converted-space">      </span>"accel_forearm_x"<span class="Apple-converted-space">      </span>"accel_forearm_y"<span class="Apple-converted-space">     </span></span></p>
<p class="p4"><span class="s1">## [49] "accel_forearm_z"<span class="Apple-converted-space">      </span>"magnet_forearm_x" <span class="Apple-converted-space">    </span>"magnet_forearm_y" <span class="Apple-converted-space">   </span></span></p>
<p class="p4"><span class="s1">## [52] "magnet_forearm_z" <span class="Apple-converted-space">    </span>"classe"</span></p>
<p class="p3"><span class="s1">#The function createDataPartition can be used to create a stratified random sample of the data into training and validation sets with 75% of the data in the training set and the rest in the test/validation set</span></p>
<p class="p3"><span class="s1">parts &lt;- createDataPartition(y=model$classe, p=0.75, list=FALSE )</span></p>
<p class="p3"><span class="s1">training &lt;- model[parts,]</span></p>
<p class="p3"><span class="s1">testing &lt;- model[-parts,]</span></p>
<p class="p3"><span class="s1">registerDoParallel() #Parallel processing along with randomForest provides great speed.</span></p>
<p class="p3"><span class="s1">x &lt;- training[-ncol(training)]</span></p>
<p class="p3"><span class="s1">y &lt;- training$classe</span></p>
<p class="p5"><span class="s1"></span><br></p>
<p class="p3"><span class="s1">rf &lt;- foreach(ntree=rep(150, 6), .combine=randomForest::combine, .packages='randomForest') %dopar% {</span></p>
<p class="p3"><span class="s1">randomForest(x, y, ntree=ntree,importance = TRUE)<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1">}</span></p>
<p class="p3"><span class="s1">print(randomForest)</span></p>
<p class="p4"><span class="s1">## function (x, ...)<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## UseMethod("randomForest")</span></p>
<p class="p4"><span class="s1">## &lt;environment: namespace:randomForest&gt;</span></p>
<p class="p3"><span class="s1">print(rf)</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## Call:</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">  </span>randomForest(x = x, y = y, ntree = ntree, importance = TRUE)<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">                </span>Type of random forest: classification</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">                      </span>Number of trees: 900</span></p>
<p class="p4"><span class="s1">## No. of variables tried at each split: 7</span></p>
<p class="p3"><span class="s1"># Few lines of code that provide error reports for both training and test data.</span></p>
<p class="p3"><span class="s1">predict_training &lt;- predict(rf, newdata=training)</span></p>
<p class="p3"><span class="s1">confusionMatrix(predict_training,training$classe)</span></p>
<p class="p4"><span class="s1">## Confusion Matrix and Statistics</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">          </span>Reference</span></p>
<p class="p4"><span class="s1">## Prediction<span class="Apple-converted-space">    </span>A<span class="Apple-converted-space">    </span>B<span class="Apple-converted-space">    </span>C<span class="Apple-converted-space">    </span>D<span class="Apple-converted-space">    </span>E</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">          </span>A 4185<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">          </span>B<span class="Apple-converted-space">    </span>0 2848<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">          </span>C<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0 2567<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">          </span>D<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0 2412<span class="Apple-converted-space">    </span>0</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">          </span>E<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0 2706</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## Overall Statistics</span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">                                     </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">                </span>Accuracy : 1 <span class="Apple-converted-space">         </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">                  </span>95% CI : (0.9997, 1)</span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">    </span>No Information Rate : 0.2843<span class="Apple-converted-space">     </span></span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">    </span>P-Value [Acc &gt; NIR] : &lt; 2.2e-16 <span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">                                     </span></span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">                  </span>Kappa : 1 <span class="Apple-converted-space">         </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">  </span>Mcnemar's Test P-Value : NA<span class="Apple-converted-space">         </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## Statistics by Class:</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">                      </span>Class: A Class: B Class: C Class: D Class: E</span></p>
<p class="p4"><span class="s1">## Sensitivity<span class="Apple-converted-space">            </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000</span></p>
<p class="p4"><span class="s1">## Specificity<span class="Apple-converted-space">            </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000</span></p>
<p class="p4"><span class="s1">## Pos Pred Value <span class="Apple-converted-space">        </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000</span></p>
<p class="p4"><span class="s1">## Neg Pred Value <span class="Apple-converted-space">        </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000</span></p>
<p class="p4"><span class="s1">## Prevalence <span class="Apple-converted-space">            </span>0.2843 <span class="Apple-converted-space">  </span>0.1935 <span class="Apple-converted-space">  </span>0.1744 <span class="Apple-converted-space">  </span>0.1639 <span class="Apple-converted-space">  </span>0.1839</span></p>
<p class="p4"><span class="s1">## Detection Rate <span class="Apple-converted-space">        </span>0.2843 <span class="Apple-converted-space">  </span>0.1935 <span class="Apple-converted-space">  </span>0.1744 <span class="Apple-converted-space">  </span>0.1639 <span class="Apple-converted-space">  </span>0.1839</span></p>
<p class="p4"><span class="s1">## Detection Prevalence <span class="Apple-converted-space">  </span>0.2843 <span class="Apple-converted-space">  </span>0.1935 <span class="Apple-converted-space">  </span>0.1744 <span class="Apple-converted-space">  </span>0.1639 <span class="Apple-converted-space">  </span>0.1839</span></p>
<p class="p4"><span class="s1">## Balanced Accuracy<span class="Apple-converted-space">      </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000 <span class="Apple-converted-space">  </span>1.0000</span></p>
<p class="p3"><span class="s1">predict_testing &lt;- predict(rf, newdata=testing)</span></p>
<p class="p3"><span class="s1">confusionMatrix(predict_testing,testing$classe)</span></p>
<p class="p4"><span class="s1">## Confusion Matrix and Statistics</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">          </span>Reference</span></p>
<p class="p4"><span class="s1">## Prediction<span class="Apple-converted-space">    </span>A<span class="Apple-converted-space">    </span>B<span class="Apple-converted-space">    </span>C<span class="Apple-converted-space">    </span>D<span class="Apple-converted-space">    </span>E</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">          </span>A 1394<span class="Apple-converted-space">    </span>1<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">          </span>B<span class="Apple-converted-space">    </span>1<span class="Apple-converted-space">  </span>945<span class="Apple-converted-space">    </span>7<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">          </span>C<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>3<span class="Apple-converted-space">  </span>847 <span class="Apple-converted-space">  </span>10<span class="Apple-converted-space">    </span>0</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">          </span>D<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>1<span class="Apple-converted-space">  </span>792<span class="Apple-converted-space">    </span>1</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">          </span>E<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>0<span class="Apple-converted-space">    </span>2<span class="Apple-converted-space">  </span>900</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## Overall Statistics</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">                                           </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">                </span>Accuracy : 0.9947 <span class="Apple-converted-space">         </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">                  </span>95% CI : (0.9922, 0.9965)</span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">    </span>No Information Rate : 0.2845 <span class="Apple-converted-space">         </span></span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">    </span>P-Value [Acc &gt; NIR] : &lt; 2.2e-16<span class="Apple-converted-space">       </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">                                           </span></span></p>
<p class="p4"><span class="s1">## <span class="Apple-converted-space">                  </span>Kappa : 0.9933 <span class="Apple-converted-space">         </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">  </span>Mcnemar's Test P-Value : NA <span class="Apple-converted-space">             </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## Statistics by Class:</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">                      </span>Class: A Class: B Class: C Class: D Class: E</span></p>
<p class="p4"><span class="s1">## Sensitivity<span class="Apple-converted-space">            </span>0.9993 <span class="Apple-converted-space">  </span>0.9958 <span class="Apple-converted-space">  </span>0.9906 <span class="Apple-converted-space">  </span>0.9851 <span class="Apple-converted-space">  </span>0.9989</span></p>
<p class="p4"><span class="s1">## Specificity<span class="Apple-converted-space">            </span>0.9997 <span class="Apple-converted-space">  </span>0.9980 <span class="Apple-converted-space">  </span>0.9968 <span class="Apple-converted-space">  </span>0.9995 <span class="Apple-converted-space">  </span>0.9995</span></p>
<p class="p4"><span class="s1">## Pos Pred Value <span class="Apple-converted-space">        </span>0.9993 <span class="Apple-converted-space">  </span>0.9916 <span class="Apple-converted-space">  </span>0.9849 <span class="Apple-converted-space">  </span>0.9975 <span class="Apple-converted-space">  </span>0.9978</span></p>
<p class="p4"><span class="s1">## Neg Pred Value <span class="Apple-converted-space">        </span>0.9997 <span class="Apple-converted-space">  </span>0.9990 <span class="Apple-converted-space">  </span>0.9980 <span class="Apple-converted-space">  </span>0.9971 <span class="Apple-converted-space">  </span>0.9998</span></p>
<p class="p4"><span class="s1">## Prevalence <span class="Apple-converted-space">            </span>0.2845 <span class="Apple-converted-space">  </span>0.1935 <span class="Apple-converted-space">  </span>0.1743 <span class="Apple-converted-space">  </span>0.1639 <span class="Apple-converted-space">  </span>0.1837</span></p>
<p class="p4"><span class="s1">## Detection Rate <span class="Apple-converted-space">        </span>0.2843 <span class="Apple-converted-space">  </span>0.1927 <span class="Apple-converted-space">  </span>0.1727 <span class="Apple-converted-space">  </span>0.1615 <span class="Apple-converted-space">  </span>0.1835</span></p>
<p class="p4"><span class="s1">## Detection Prevalence <span class="Apple-converted-space">  </span>0.2845 <span class="Apple-converted-space">  </span>0.1943 <span class="Apple-converted-space">  </span>0.1754 <span class="Apple-converted-space">  </span>0.1619 <span class="Apple-converted-space">  </span>0.1839</span></p>
<p class="p4"><span class="s1">## Balanced Accuracy<span class="Apple-converted-space">      </span>0.9995 <span class="Apple-converted-space">  </span>0.9969 <span class="Apple-converted-space">  </span>0.9937 <span class="Apple-converted-space">  </span>0.9923 <span class="Apple-converted-space">  </span>0.9992</span></p>
<p class="p3"><span class="s1">x &lt;- ed</span></p>
<p class="p3"><span class="s1">x &lt;- x[sets[sets!='classe']]</span></p>
<p class="p3"><span class="s1">answers &lt;- predict(rf, newdata=x)</span></p>
<p class="p5"><span class="s1"></span><br></p>
<p class="p3"><span class="s1">answers</span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">  </span>1<span class="Apple-converted-space">  </span>2<span class="Apple-converted-space">  </span>3<span class="Apple-converted-space">  </span>4<span class="Apple-converted-space">  </span>5<span class="Apple-converted-space">  </span>6<span class="Apple-converted-space">  </span>7<span class="Apple-converted-space">  </span>8<span class="Apple-converted-space">  </span>9 10 11 12 13 14 15 16 17 18 19 20<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">##<span class="Apple-converted-space">  </span>B<span class="Apple-converted-space">  </span>A<span class="Apple-converted-space">  </span>B<span class="Apple-converted-space">  </span>A<span class="Apple-converted-space">  </span>A<span class="Apple-converted-space">  </span>E<span class="Apple-converted-space">  </span>D<span class="Apple-converted-space">  </span>B<span class="Apple-converted-space">  </span>A<span class="Apple-converted-space">  </span>A<span class="Apple-converted-space">  </span>B<span class="Apple-converted-space">  </span>C<span class="Apple-converted-space">  </span>B<span class="Apple-converted-space">  </span>A<span class="Apple-converted-space">  </span>E<span class="Apple-converted-space">  </span>E<span class="Apple-converted-space">  </span>A<span class="Apple-converted-space">  </span>B<span class="Apple-converted-space">  </span>B<span class="Apple-converted-space">  </span>B<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1">## Levels: A B C D E</span></p>
<p class="p3"><span class="s1">pml_write_files = function(x){</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">  </span>n = length(x)</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">  </span>for(i in 1:n){</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">    </span>filename = paste0("problem_id_",i,".txt")</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">    </span>write.table(x[i],file=filename,quote=FALSE,row.names=FALSE,col.names=FALSE)</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p3"><span class="s1">}</span></p>
<p class="p5"><span class="s1"></span><br></p>
<p class="p3"><span class="s1">pml_write_files(answers)</span></p>
</body>
</html>
